"use strict";angular.module("npmalerts",["ui.bootstrap"]),Ladda.bind(".ladda-button"),angular.module("npmalerts").controller("SignUpCtrl",["$scope","$http","$location","Subscription",function(a,b,c,d){a.alerts=[],a.email=c.search().email||null,a.url=c.search().repo||null,a.isAdding=!(a.email&&a.url),a.displayAlert=function(b){a.alerts.push({type:"danger",msg:b})},a.displaySuccess=function(b){a.alerts.push({type:"success",msg:b})},a.closeAlert=function(b){a.alerts.splice(b,1)},a.submit=function(){a.alerts=[],a.isAdding?a.submitWatch():a.submitUnwatch()},a.submitWatch=function(){d.add(a.email,a.url,!!a.ignorePatches).success(function(){a.url="",a.displaySuccess("Done! Now when there's a new package version available we'll let you know.")}).error(function(b){_.each(b.messages,a.displayAlert)})["finally"](function(){Ladda.stopAll()})},a.submitUnwatch=function(){d.remove(a.email,a.url).success(function(){a.url="",a.displaySuccess("Done! You won't receive any more notifications about that project.")}).error(function(b){_.each(b.messages,a.displayAlert)})["finally"](function(){Ladda.stopAll()})}}]),angular.module("npmalerts").service("Subscription",["$http",function(a){return{add:function(b,c,d){var e={email:b,repo:c,patch:!!d},f=a.put("http://npmalerts.herokuapp.com/api/subscriptions",e);return f.success(function(){ga("send","event","subscriptions","signup",b)}),f.error(function(a){ga("send","exception",{exDescription:"SignupError: "+a})}),f},remove:function(b,c){var d=a["delete"]("http://npmalerts.herokuapp.com/api/subscriptions?email="+b+"&repo="+c);return d.success(function(){ga("send","event","subscriptions","remove",b)}),d.error(function(a){ga("send","exception",{exDescription:"UnsubscribeError "+a})}),d}}}]);